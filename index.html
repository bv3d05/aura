-- Local HTML Menu
print("Loading Local HTML Menu...")

local menuVisible = false
local currentIndex = 4

-- HTML Ù…Ø¯Ù…Ø¬ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯
local htmlContent = [[
<!DOCTYPE html>
<html>
<head>
    <style>
        body { background: transparent; margin: 0; padding: 50px; font-family: Arial; color: white; }
        .menu { width: 300px; background: rgba(0,0,0,0.8); border: 2px solid #64ffb4; border-radius: 10px; padding: 20px; }
        .title { font-size: 24px; text-align: center; margin-bottom: 20px; color: #64ffb4; }
        .item { padding: 10px; margin: 5px 0; border-radius: 5px; transition: all 0.3s; }
        .item.selected { background: rgba(100,255,180,0.3); transform: translateX(10px); }
        .item .icon { display: inline-block; width: 30px; }
        .item .text { margin-left: 10px; }
    </style>
</head>
<body>
    <div class="menu" id="menu" style="display:none;">
        <div class="title">AURA MENU</div>
        <div class="item" data-index="0"><span class="icon">ğŸ‘¤</span><span class="text">Self</span></div>
        <div class="item" data-index="1"><span class="icon">ğŸŒ</span><span class="text">Online</span></div>
        <div class="item" data-index="2"><span class="icon">âš”ï¸</span><span class="text">Combat</span></div>
        <div class="item" data-index="3"><span class="icon">ğŸ‘ï¸</span><span class="text">Visual</span></div>
        <div class="item selected" data-index="4"><span class="icon">ğŸš—</span><span class="text">Vehicle</span></div>
        <div class="item" data-index="5"><span class="icon">ğŸ“‚</span><span class="text">Misc</span></div>
        <div class="item" data-index="6"><span class="icon">ğŸ’¥</span><span class="text">Destructive</span></div>
        <div class="item" data-index="7"><span class="icon">âš¡</span><span class="text">Triggers</span></div>
        <div class="item" data-index="8"><span class="icon">âš™ï¸</span><span class="text">Settings</span></div>
    </div>
    <script>
        let currentIndex = 4;
        const items = document.querySelectorAll('.item');
        const menu = document.getElementById('menu');
        
        function updateSelection(index) {
            items.forEach((item, i) => {
                item.classList.remove('selected');
                if (i === index) item.classList.add('selected');
            });
        }
        
        window.addEventListener('message', function(event) {
            const data = event.data;
            if (data.type === 'show') {
                menu.style.display = 'block';
                updateSelection(data.index || 4);
            } else if (data.type === 'hide') {
                menu.style.display = 'none';
            } else if (data.type === 'update') {
                updateSelection(data.index);
            }
        });
    </script>
</body>
</html>
]]

-- Ø¥Ù†Ø´Ø§Ø¡ DUI Ù…Ø­Ù„ÙŠ
local menuDUI = nil
local duiHandle = nil
local txd = nil
local texture = nil

Citizen.CreateThread(function()
    -- Ø¥Ù†Ø´Ø§Ø¡ HTML Ù…Ø­Ù„ÙŠ
    menuDUI = CreateDui("data:text/html;charset=utf-8," .. htmlContent, 400, 600)
    
    if menuDUI then
        Citizen.Wait(2000)
        duiHandle = GetDuiHandle(menuDUI)
        
        if duiHandle then
            txd = CreateRuntimeTxd('local_menu')
            texture = CreateRuntimeTextureFromDuiHandle(txd, 'menu_tex', duiHandle)
            
            if texture then
                print("âœ… Local HTML menu ready - Press F6")
            end
        end
    end
end)

-- Ø§Ù„ØªØ­ÙƒÙ…
function OpenLocalMenu()
    if not texture then return end
    if menuVisible then return end
    
    SendDuiMessage(menuDUI, json.encode({type = "show", index = currentIndex}))
    menuVisible = true
    print("âœ… Local menu opened")
end

function CloseLocalMenu()
    if not menuVisible then return end
    SendDuiMessage(menuDUI, json.encode({type = "hide"}))
    menuVisible = false
    print("âœ… Local menu closed")
end

-- Ø§Ù„Ø±Ø³Ù… ÙˆØ§Ù„ØªØ­ÙƒÙ…
Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)
        
        if menuVisible and texture then
            DrawSprite('local_menu', 'menu_tex', 0.2, 0.5, 0.25, 0.5, 0.0, 255, 255, 255, 255)
        end
        
        if menuVisible then
            DisableAllControlActions(0)
            EnableControlAction(0, 245, true)
            
            if IsControlJustPressed(0, 172) then -- Up
                currentIndex = currentIndex > 0 and currentIndex - 1 or 8
                SendDuiMessage(menuDUI, json.encode({type = "update", index = currentIndex}))
            elseif IsControlJustPressed(0, 173) then -- Down
                currentIndex = currentIndex < 8 and currentIndex + 1 or 0
                SendDuiMessage(menuDUI, json.encode({type = "update", index = currentIndex}))
            elseif IsControlJustPressed(0, 176) then -- Enter
                local names = {"Self", "Online", "Combat", "Visual", "Vehicle", "Misc", "Destructive", "Triggers", "Settings"}
                print("Selected: " .. names[currentIndex + 1])
                CloseLocalMenu()
            elseif IsControlJustPressed(0, 322) then -- ESC
                CloseLocalMenu()
            end
        end
        
        if IsControlJustPressed(0, 167) then -- F6
            if menuVisible then CloseLocalMenu() else OpenLocalMenu() end
        end
    end
end)

print("ğŸŒŸ Local HTML Menu Loaded")
